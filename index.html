<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NBA Analysis</title>
    <link rel="stylesheet" href="style.css">
    <script>
        async function loadJSON() {
            const response = await fetch('results/player_movements_cleaned.json');
            const data = await response.json();
            populateTable(data);
        }

        function populateTable(data) {
            const tableBody = document.getElementById('data-table-body');
            const tableHead = document.getElementById('data-table-head');
            tableBody.innerHTML = ''; // Clear existing content

            // Dynamically generate table headers based on the first entry's keys
            const headers = Object.keys(data[0]);
            tableHead.innerHTML = ''; // Clear existing headers
            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                th.onclick = () => sortTable(headers.indexOf(header)); // Sort function on header click
                tableHead.appendChild(th);
            });

            // Populate table rows with data
            data.forEach(player => {
                const row = document.createElement('tr');
                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.textContent = player[header];
                    row.appendChild(td);
                });
                tableBody.appendChild(row);
            });
        }

        // Sorting function for each column
        function sortTable(columnIndex, ascending = true) {
            const rows = Array.from(document.getElementById('data-table-body').children);
            rows.sort((a, b) => {
                const aVal = a.children[columnIndex].innerText;
                const bVal = b.children[columnIndex].innerText;

                if (!isNaN(parseFloat(aVal)) && !isNaN(parseFloat(bVal))) {
                    return ascending
                        ? parseFloat(aVal) - parseFloat(bVal)
                        : parseFloat(bVal) - parseFloat(aVal);
                }
                return ascending
                    ? aVal.localeCompare(bVal)
                    : bVal.localeCompare(aVal);
            });

            const tableBody = document.getElementById('data-table-body');
            tableBody.innerHTML = ''; // Clear table body
            rows.forEach(row => tableBody.appendChild(row)); // Add sorted rows
        }

        window.onload = loadJSON;
    </script>
</head>
<body>
    <h1>NBA Analysis Project</h1>
    <p>Hello, my name is Jeremy Dang and I am part of the Big Data Analytics graduate program at San Diego State University. Welcome to my NBA Analysis project! Below are the main resources for this project:</p>
    <ul>
        <li><a href="reports/Final%20Report.pdf" target="_blank">Final Report</a></li>
        <li><a href="results/player_movements_cleaned.json" target="_blank">JSON Dataset</a></li>
        <li><a href="https://github.com/danceswithme/nba_analysis" target="_blank">GitHub Repository</a></li>
		<li><a href="https://github.com/danceswithme/nba_analysis/blob/main/README.md" target="_blank">README</a></li>
    </ul>
    <footer>
        <p>Â© 2024 NBA Analysis Project</p>
    </footer>

    <<h2>Player Movement Data</h2>

	<!-- Note explaining sorting functionality -->
	<p><em>Click on the column names to sort the data in ascending or descending order.</em></p>

	<div class="table-container">
		<table border="1">
			<thead id="data-table-head">
				<!-- Table headers will be dynamically populated here -->
			</thead>
			<tbody id="data-table-body">
				<!-- Table rows will be dynamically populated here -->
			</tbody>
		</table>
	</div>

</body>
</html>
