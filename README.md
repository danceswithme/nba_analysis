# NBA Data Analysis

This project involves analyzing NBA player data, converting city names to geographic coordinates, and storing the data in MongoDB. Additionally, it integrates API requests for annual temperature, cost of living, and tax rates for the cities where players have moved.

## Project Structure

nba_analysis/

├── data/

├── notebooks/

├── results/

├── scripts/

├── venv/

├── .gitignore

├── README.md

├── requirements.txt



## Setup Instructions

### 1. Clone the Repository

Clone this repository to your local machine.

```sh
git clone https://github.com/danceswithme/nba_analysis.git
cd nba_analysis
```

2. Create and Activate a Virtual Environment
On Windows
Create the Virtual Environment:

```sh
python -m venv venv
```

Activate the Virtual Environment:
```
venv\Scripts\activate
```

3. Install Required Packages
With the virtual environment activated, install the necessary packages:
```sh
pip install -r requirements.txt
```

4. Install MongoDB
Follow the instructions to install MongoDB from the official MongoDB website.

5. Install QGIS
Follow the instructions to install QGIS from the official QGIS website.


6. Ensure MongoDB is Running
Make sure MongoDB is running. You can start the MongoDB service by typing:
```sh
net start MongoDB
```

7. Using QGIS
Open the QGIS project file located in the 'qgis' directory within QGIS.

## Project Overview
This repository contains CSV and Excel files sourced from basketball-reference.com. The data includes player statistics based on specific criteria listed in the first sheet of the players_that_fit_query.xlsx file.

## Data Source
The CSV and Excel files were generated by conducting lookups on basketball-reference.com. Players were selected based on predefined criteria detailed in the first sheet of the players_that_fit_query.xlsx.

## File Descriptions
players_that_fit_query.xlsx: Excel file containing detailed criteria and the list of players who meet those criteria sourced from basketball-reference.com.
players_data.csv: CSV file with aggregated statistics of players meeting the specified criteria.

## Data Files
results/player_movements.json: JSON file containing player movements data.
results/player_movements_tax.json: JSON file containing player movements with tax data.
results/player_movements_pci.json: JSON file containing player movements with PCI data.
results/player_movements_temp.json: JSON file containing temporary player movements data.

## Getting Started

To get started, clone the repository and follow the instructions in each script and notebook. Ensure you have the necessary dependencies installed, which can be found in the `requirements.txt` file.

## Data Sources

- **Temperature Data**: Retrieved from Open-Meteo.
- **PCI Data**: Collected from various sources for US states and Toronto.
- **Tax Rate Data**: Obtained from the Tax Foundation.

## Dependencies

- Python 3.x
- pymongo
- MongoDB
- QGIS
- Jupyter
- pandas
- matplotlib
- seaborn

Ensure you have these dependencies installed to successfully run the scripts and notebooks in this project.

# NBA Player Movement Analysis

This repository contains scripts and notebooks for analyzing the movement of NBA players between cities, focusing on various factors such as tax rates, per capita income (PCI), and annual temperatures.

## Python Scripts

### City and State Updates
- **update_city_state.py**: Adds state abbreviations to city data.

### Annual Temperature Data
- **annual_temperature_lookup.py**: Searches Open-Meteo for average temperature of cities and their given years.
- **finish_temperature.py**: Completes temperature data retrieval.

### Cost of Living
- **insert_pci_data.py**: Collects per capita income (PCI) for all US states and adds it to MongoDB.
- **insert_toronto_pci.py**: Collects PCI for Toronto and adds it to MongoDB.
- **update_pci_data.py**: Updates the player_movements collection with PCI for the states in the player documents.

### Tax Rate Data
- **tax_rate.py**: Sets tax rate tiers and years for US states and Ontario, obtained from Tax Foundation.
- **add_tax_player_movement.py**: Fills out documents in player_movements according to the tax_rate.py.

### Data Separation
- **separate_collections.py**: Creates new collections in MongoDB that only contain documents with either annual temperature, cost of living (PCI), or tax rate.

## Jupyter Notebooks

### Regression Analysis
- **regression1.ipynb**: Performs regression analysis on the dataset to determine the impact of different factors on player movements.

### Graphing
- **graphing.ipynb**: Generates various bar charts and visualizations to illustrate the data, including PCI, tax tiers, and temperature differences.

## Notebooks for Data Analysis
regression1.ipynb - runs significance tests on JSON files created from the data to see if any variables have a significant difference between previous and new cities or states
graphing.ipynb - creates bar charts the above data for both differences in previous and new and for dataset to visualize

## Notes
Ensure that the Excel file is named Players that fit Query.xls and the sheet is named Final List.
Make sure the CSV file is named Players that fit Query - Final List.csv.
Adjust the file paths in the script if your directory structure differs.

## Data
The data files are located in the 'nba_analysis/data' directory.

## Scripts
The Python script files are located in the 'nba_analysis/scripts' directory.

## Notebooks
Jupyter and other notebooks used for data analysis, along with output files are located in the 'nba_analysis/notebooks' directory.

## Results
Analysis results are saved in the 'nba_analysis/results' directory.

## Contributing 
Feel free to submit issues or pull requests if you have any improvements or fixes.

## License
This project is licensed under the MIT License.

## Acknowledgements
A small list of the wonderful resources that aided in this project include MongoDB, basketball-reference.com, taxfoundation.org, REAP Project, open-meteo.com for historical weather API
